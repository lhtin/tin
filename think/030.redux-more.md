# Redux中的store增强器

从Redux的源代码可以看出，核心部分只做了一件事情：**当有action发出时，调用开发者提供的reducer来处理action，得到新的state。**除此之外，还提供了三个工具，分别是用于方便编写reducers的`combileReducers`、用于自动结合action和dispatch的`bindActionCreators`、以及用于方便编写store增强器的`applyMiddleware`和`compose`。

最有意思的是store增强器，也就是`createStore`函数的第三个参数`enhancer`。如果传入该参数，`createStore`会直接返回`enhancer(createStore)(reducer, preloadedState)`，调用创建`store`对象的过程交由`enhancer`去做。因此，增强器既可以操作`reducer`函数，也可以操作创建后的`store`对象。

```js
export default function createStore(reducer, preloadedState, enhancer) {

  // 省略前面的代码

  // 处理传入的enhancer部分
  if (typeof enhancer !== 'undefined') {
    if (typeof enhancer !== 'function') {
      throw new Error('Expected the enhancer to be a function.')
    }

    return enhancer(createStore)(reducer, preloadedState)
  }

  // 省略后面的代码

}
```



